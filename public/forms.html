<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Form Submissions</title>
  <link rel="stylesheet" href="css/form.css">
</head>
<body>
  <div class="form-container">
    <h1>Pending Join Requests</h1>
    <div id="requests"></div>
  </div>

  <script>
    async function loadRequests() {
      try {
        const response = await fetch('/requests');
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        const requests = await response.json();
        const container = document.getElementById('requests');
        container.innerHTML = '';

        requests.forEach(req => {
          const div = document.createElement('div');
          div.className = 'request';
          div.innerHTML = `
            <p><strong>Username:</strong> ${req.username}</p>
            <p><strong>Age:</strong> ${req.age}</p>
            <p><strong>Discord:</strong> ${req.discord}</p>
            <p><strong>Reason:</strong> ${req.reason}</p>
            <button onclick="approve('${req.id}')">Approve</button>
            <button onclick="deny('${req.id}')">Deny</button>
          `;
          container.appendChild(div);
        });
      } catch (err) {
        console.error('Error loading requests:', err);
      }
    }

    async function approve(id) {
      await fetch(`/approve/${id}`, { method: 'POST' });
      loadRequests();
    }

    async function deny(id) {
      await fetch(`/deny/${id}`, { method: 'POST' });
      loadRequests();
    }

    loadRequests();
  </script>
</body>
</html>
